{
	"info": {
		"_postman_id": "47808c59-362d-4f86-8f7d-572aa61d0c42",
		"name": "Code Generation",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Meta Documentation",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "50f48092-9396-447c-a1b6-c5f16ffbb697",
						"exec": [
							"",
							"const currentRaw = JSON.parse(postman.getEnvironmentVariable('documentation_current'));",
							"const currentParts = currentRaw.match(/^\\# [A-z0-9]+\\n+((?:.|\\n)*)\\n+(<table>(?:.|\\n)*?<\\/table>|(?:\\n\\|.*\\|)+)((.|\\n)*)/);",
							"",
							"const currentFields = {};",
							"",
							"const currentDescription = currentParts ? currentParts[1] : '';",
							"const currentExtraInfo = currentParts ? currentParts[3] : '';",
							"const currentRawTable = currentParts ? currentParts[2].trim() : '';",
							"if (/<table>/.test(currentRawTable)) {",
							"    const $ = cheerio.load(currentRawTable);",
							"",
							"",
							"    $('tr').each((index, row) => {",
							"        row = $(row);",
							"        if(row.attr('class') === 'header') {",
							"            return;",
							"        }",
							"        const columns = $('td', row);",
							"        currentFields[$(columns[0]).html()] = {",
							"            type: $(columns[1]).html(),",
							"            description: $(columns[2]).html(),",
							"            optional: $(columns[3]).html().toLowerCase() !== 'x',",
							"            readOnly: $(columns[4]).html().toLowerCase() === 'x',",
							"        };",
							"    });",
							"} else {",
							"    const rows = currentRawTable.split('\\n');",
							"    rows.forEach((row, index) => {",
							"        if (index < 2) {",
							"            return; //Ignore headers",
							"        }",
							"        row = row.trim();",
							"        const columns = row.substring(1, row.length - 1).split('|').map(column => column.trim());",
							"        while(columns.length < 5) {",
							"            columns.push('');",
							"        }",
							"        currentFields[columns[0]] = {",
							"            type: columns[1],",
							"            description: columns[2],",
							"            optional: columns[3].toLowerCase() !== 'x',",
							"            readOnly: columns[4].toLowerCase() === 'x',",
							"        };",
							"    })",
							"}",
							"",
							"let jsonData = JSON.parse(responseBody);",
							"let customCounts = {",
							"    customText: 1,",
							"    customTextBlock: 1,",
							"    customDate: 1,",
							"    customFloat: 1,",
							"    customInt: 1,",
							"};",
							"let fields = jsonData.fields",
							".sort((fieldA, fieldB) => {",
							"    if (fieldA.name === 'id') {",
							"        return -1;",
							"    }",
							"    if (fieldB.name === 'id') {",
							"        return 1;",
							"    }",
							"    return fieldA.name < fieldB.name ? -1 : 1;",
							"})",
							".filter((field) => {",
							"    if (field.name !== 'customText1' && /^customText[0-9]+/.test(field.name)) {",
							"        customCounts.customText++;",
							"        return false;",
							"    }",
							"    if (field.name !== 'customTextBlock1' && /^customTextBlock[0-9]+/.test(field.name)) {",
							"        customCounts.customTextBlock++;",
							"        return false;",
							"    }",
							"    if (field.name !== 'customDate1' && /^customDate[0-9]+/.test(field.name)) {",
							"        customCounts.customDate++;",
							"        return false;",
							"    }",
							"    if (field.name !== 'customFloat1' && /^customFloat[0-9]+/.test(field.name)) {",
							"        customCounts.customFloat++;",
							"        return false;",
							"    }",
							"    if (field.name !== 'customInt1' && /^customInt/.test(field.name)) {",
							"        customCounts.customInt++;",
							"        return false;",
							"    }",
							"    return true;",
							"})",
							".map((field) => {",
							"    switch(field.type) {",
							"        case 'TO_ONE':",
							"            field.type = `To-one Association`",
							"            break;",
							"        case 'TO_MANY':",
							"            field.type = `To-many Association`",
							"            break;",
							"    }",
							"    let description = field.optionsType || '';",
							"    switch(field.name) {",
							"        case 'id':",
							"            description = 'Unique identifier for this entity.';",
							"            break;",
							"        case 'customText1':",
							"            field.name = `customText1-${customCounts.customText}`;",
							"            description = 'Configurable text fields that can be used to store custom data depending on the needs of a particular deployment.';",
							"            break;",
							"        case 'customTextBlock1':",
							"            field.name = `customTextBlock1-${customCounts.customTextBlock}`;",
							"            description = 'Configurable text fields that can be used to store custom data depending on the needs of a particular deployment.';",
							"            break;",
							"        case 'customDate1':",
							"            field.name = `customDate1-${customCounts.customDate}`;",
							"            description = 'Configurable date fields that can be used to store custom data depending on the needs of a particular deployment.';",
							"            break;",
							"        case 'customFloat1':",
							"            field.name = `customFloat1-${customCounts.customFloat}`;",
							"            description = 'Configurable numeric fields that can be used to store custom data depending on the needs of a particular deployment.';",
							"            break;",
							"        case 'customInt1':",
							"            field.name = `customInt1-${customCounts.customInt}`;",
							"            description = 'Configurable numeric fields that can be used to store custom data depending on the needs of a particular deployment.';",
							"            break;",
							"    }",
							"    if (field.type === 'SCALAR') {",
							"        field.type = field.dataType;",
							"    }",
							"    if (field.type === 'String') {",
							"        field.type += ` (${field.maxLength})`;",
							"    }",
							"    if (field.name === 'id') {",
							"        field.type = 'Integer';",
							"        field.optional = false;",
							"        field.readOnly = true;",
							"    }",
							"    if (currentFields[field.name]) {",
							"        const currentField = currentFields[field.name];",
							"        field.optional = currentField.optional;",
							"        description = currentField.description;",
							"        field.readOnly = currentField.readOnly;",
							"    }",
							"    return {",
							"        name: field.name,",
							"        type: field.type,",
							"        description: description,",
							"        notNull: !field.optional,",
							"        readOnly: field.readOnly,",
							"    };",
							"});",
							"",
							"let fieldOutput = fields.map((field, index) => {",
							"    return `        <tr class=\"${index % 2 === 0 ? 'even' : 'odd'}\">",
							"            <td>${field.name}</td>",
							"            <td>${field.type}</td>",
							"            <td>${field.description}</td>",
							"            <td>${field.notNull?'X':''}</td>",
							"            <td>${field.readOnly?'X':''}</td>",
							"        </tr>`;",
							"}).join(\"\\n\");",
							"let output = `# ${jsonData.entity}",
							"",
							"${currentDescription}",
							"",
							"<table>",
							"    <colgroup>",
							"        <col width=\"20%\" />",
							"        <col width=\"20%\" />",
							"        <col width=\"20%\" />",
							"        <col width=\"20%\" />",
							"        <col width=\"20%\" />",
							"    </colgroup>",
							"    <thead>",
							"        <tr class=\"header\">",
							"            <th>${jsonData.entity} fields</th>",
							"            <th>Type</th>",
							"            <th>Description</th>",
							"            <th>Not null</th>",
							"            <th>Read-only</th>",
							"        </tr>",
							"    </thead>",
							"    <tbody>",
							"${fieldOutput}",
							"    </tbody>",
							"</table>${currentExtraInfo}`;",
							"pm.test(`${jsonData.entity} to view: View -> Show Postman Console`, () => {",
							"    console.log(output);",
							"    pm.expect(true).to.eql(true);",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"id": "6c0683df-d18f-434c-a603-fd02037a0141",
						"exec": [
							"//If it is a new entity, fill in originalEntity, if it is an existing entity, copy and paste the current documentation",
							"const originalEntity = '';",
							"const original = `# JobSubmissionCertificationRequirement",
							"",
							"This entity represents the required certifications for a Job Submission.",
							"",
							"",
							"<table>",
							"    <colgroup>",
							"        <col width=\"20%\" />",
							"        <col width=\"20%\" />",
							"        <col width=\"20%\" />",
							"        <col width=\"20%\" />",
							"        <col width=\"20%\" />",
							"    </colgroup>",
							"    <thead>",
							"        <tr class=\"header\">",
							"            <th>JobSubmissionCertificationRequirement fields</th>",
							"            <th>Type</th>",
							"            <th>Description</th>",
							"            <th>Not null</th>",
							"            <th>Read-only</th>",
							"        </tr>",
							"    </thead>",
							"    <tbody>",
							"        <tr class=\"even\">",
							"            <td>id</td>",
							"            <td>ID</td>",
							"            <td>Unique identifier for this entity.</td>",
							"            <td>X</td>",
							"            <td>X</td>",
							"        </tr>",
							"        <tr class=\"odd\">",
							"            <td>candidateCertification</td>",
							"            <td>To One Association</td>",
							"            <td>CandidateCertification that fulfills this Requirement.</td>",
							"            <td></td>",
							"            <td></td>",
							"        </tr>",
							"        <tr class=\"even\">",
							"            <td>certification</td>",
							"            <td>To One Association</td>",
							"            <td>The Certification that is required.</td>",
							"            <td>X</td>",
							"            <td></td>",
							"        </tr>",
							"        <tr class=\"odd\">",
							"            <td>certificationFileAttachments</td>",
							"            <td>To Many Association</td>",
							"            <td>CertificationFileAttachment</td>",
							"            <td></td>",
							"            <td>X</td>",
							"        </tr>",
							"        <tr class=\"even\">",
							"            <td>customDate1-10</td>",
							"            <td>Timestamp</td>",
							"            <td>Configurable date fields that can be used to store custom data depending on the needs of a particular deployment.</td>",
							"            <td></td>",
							"            <td></td>",
							"        </tr>",
							"        <tr class=\"odd\">",
							"            <td>customFloat1-3</td>",
							"            <td>Double</td>",
							"            <td>Configurable numeric fields that can be used to store custom data depending on the needs of a particular deployment.</td>",
							"            <td></td>",
							"            <td></td>",
							"        </tr>",
							"        <tr class=\"even\">",
							"            <td>customInt1-3</td>",
							"            <td>Integer</td>",
							"            <td>Configurable numeric fields that can be used to store custom data depending on the needs of a particular deployment.</td>",
							"            <td></td>",
							"            <td></td>",
							"        </tr>",
							"        <tr class=\"odd\">",
							"            <td>customText1-10</td>",
							"            <td>String (100)</td>",
							"            <td>Configurable text fields that can be used to store custom data depending on the needs of a particular deployment.</td>",
							"            <td></td>",
							"            <td></td>",
							"        </tr>",
							"        <tr class=\"even\">",
							"            <td>customTextBlock1-10</td>",
							"            <td>String (2147483647)</td>",
							"            <td>Configurable text fields that can be used to store custom data depending on the needs of a particular deployment.</td>",
							"            <td></td>",
							"            <td></td>",
							"        </tr>",
							"        <tr class=\"odd\">",
							"            <td>dateAdded</td>",
							"            <td>Timestamp</td>",
							"            <td></td>",
							"            <td>X</td>",
							"            <td>X</td>",
							"        </tr>",
							"        <tr class=\"even\">",
							"            <td>dateExpiration</td>",
							"            <td>Timestamp</td>",
							"            <td></td>",
							"            <td></td>",
							"            <td>X</td>",
							"        </tr>",
							"        <tr class=\"odd\">",
							"            <td>dateLastModified</td>",
							"            <td>Timestamp</td>",
							"            <td></td>",
							"            <td></td>",
							"            <td></td>",
							"        </tr>",
							"        <tr class=\"even\">",
							"            <td>documentDeadline</td>",
							"            <td>Timestamp</td>",
							"            <td></td>",
							"            <td></td>",
							"            <td></td>",
							"        </tr>",
							"        <tr class=\"odd\">",
							"            <td>fileAttachments</td>",
							"            <td>To Many Association</td>",
							"            <td>CandidateFileAttachment</td>",
							"            <td></td>",
							"            <td></td>",
							"        </tr>",
							"        <tr class=\"even\">",
							"            <td>isDeleted</td>",
							"            <td>Boolean</td>",
							"            <td><p><span>Whether entity is deleted.</span></p>",
							"<p><span> <span>The default value is false.</span> </span></p></td>",
							"            <td>X</td>",
							"            <td></td>",
							"        </tr>",
							"        <tr class=\"odd\">",
							"            <td>jobSubmission</td>",
							"            <td>To One Association</td>",
							"            <td>JobSubmission</td>",
							"            <td>X</td>",
							"            <td></td>",
							"        </tr>",
							"        <tr class=\"even\">",
							"            <td>matchingCredentialCount</td>",
							"            <td>Integer</td>",
							"            <td></td>",
							"            <td></td>",
							"            <td>X</td>",
							"        </tr>",
							"        <tr class=\"odd\">",
							"            <td>migrateGUID</td>",
							"            <td>String (36)</td>",
							"            <td></td>",
							"            <td></td>",
							"            <td></td>",
							"        </tr>",
							"        <tr class=\"even\">",
							"            <td>modifyingUser</td>",
							"            <td>To One Association</td>",
							"            <td>CorporateUser</td>",
							"            <td>X</td>",
							"            <td>X</td>",
							"        </tr>",
							"        <tr class=\"odd\">",
							"            <td>owner</td>",
							"            <td>To One Association</td>",
							"            <td>CorporateUser</td>",
							"            <td></td>",
							"            <td></td>",
							"        </tr>",
							"        <tr class=\"even\">",
							"            <td>status</td>",
							"            <td>To One Association</td>",
							"            <td>CertificationRequirementStatusLookup</td>",
							"            <td></td>",
							"            <td></td>",
							"        </tr>",
							"        <tr class=\"odd\">",
							"            <td>userCertificationName</td>",
							"            <td>String (100)</td>",
							"            <td></td>",
							"            <td></td>",
							"            <td>X</td>",
							"        </tr>",
							"        <tr class=\"even\">",
							"            <td>userCertificationStatus</td>",
							"            <td>String (30)</td>",
							"            <td></td>",
							"            <td></td>",
							"            <td>X</td>",
							"        </tr>",
							"    </tbody>",
							"</table>",
							"",
							"`;",
							"",
							"",
							"",
							"",
							"",
							"",
							"if (original && originalEntity) {",
							"    throw new Error('You must fill out either the original or the originalEntity');",
							"}",
							"",
							"postman.setEnvironmentVariable('documentation_current', JSON.stringify(original));",
							"postman.setEnvironmentVariable('documentation_entity', originalEntity || original.match(/^\\# ([A-z0-9]+)/)[1]);"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{restUrl}}meta/{{documentation_entity}}?fields=*&meta=full",
					"host": [
						"{{restUrl}}meta"
					],
					"path": [
						"{{documentation_entity}}"
					],
					"query": [
						{
							"key": "fields",
							"value": "*"
						},
						{
							"key": "meta",
							"value": "full"
						}
					]
				}
			},
			"response": []
		}
	],
	"protocolProfileBehavior": {}
}